<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Asset Details</title>
  <link rel="stylesheet" href="/style.css" />
</head>

<body>

<header>
  <div class="nav-container">
    <div class="logo">Crypto Watcher</div>

    <nav>
      <a href="/">Home</a>
      <a href="/admin">Admin</a>
      <a href="/about">About</a>
      <a href="/contact">Contact</a>
      <a href="/search">Search</a>
      <a href="/login">Login</a>
    </nav>
  </div>
</header>


<section class="hero hero-small">
  <h1 id="title">Loading...</h1>
  <p id="subtitle">Please wait</p>
</section>


<main>

  <div class="asset-page">

    <div class="asset-left">
      <img id="image" />
    </div>


    <div class="asset-right">

      <h2 id="name"></h2>

      <div class="badge" id="symbol"></div>

      <p class="desc" id="description"></p>


      <div class="stats">

        <div class="stat">
          <span>Price</span>
          <b id="price">$0</b>
        </div>

        <div class="stat">
          <span>Market Cap</span>
          <b id="cap">$0</b>
        </div>

        <div class="stat">
          <span>24h Change</span>
          <b id="change">0%</b>
        </div>

      </div>


      <div class="buttons">
        <a href="/search" class="btn">Back</a>
        <a href="/" class="btn primary">Home</a>
      </div>


      <p class="api">
        API:
        <a id="api" target="_blank"></a>
      </p>

    </div>

  </div>

</main>


<footer>
  Crypto Watcher Â© 2025
</footer>


<script>

function money(n){
  if(!n) return "-";
  return "$" + Number(n).toLocaleString();
}


async function load(){

  const id = location.pathname.split("/").pop();

  const url = "/api/assets/" + id;

  document.getElementById("api").href = url;
  document.getElementById("api").textContent = url;


  try{

    const res = await fetch(url);
    const a = await res.json();

    if(!res.ok){
      document.getElementById("title").textContent = "Not Found";
      document.getElementById("subtitle").textContent = "Asset not found";
      return;
    }


    document.getElementById("title").textContent = a.name;
    document.getElementById("subtitle").textContent = a.symbol;

    document.getElementById("name").textContent = a.name;
    document.getElementById("symbol").textContent = a.symbol;

    document.getElementById("description").textContent =
      a.description || "No description";

    document.getElementById("price").textContent = money(a.price);
    document.getElementById("cap").textContent = money(a.marketCap);


    let ch = a.change24h;

    if(ch !== null && ch !== undefined){
      ch = Number(ch).toFixed(2);
      document.getElementById("change").textContent = ch + "%";
    }


    document.getElementById("image").src =
      a.imageUrl || "https://images.unsplash.com/photo-1621416894569-0f39ed31d247";


  }catch(e){

    document.getElementById("title").textContent = "Error";
    document.getElementById("subtitle").textContent = "Server error";

  }

}

load();

</script>

</body>
</html>
